import os


def change_name():
    path = "E:\\final_exe_lists\\dirs_first_exe_32_bit.txt"
    with open(path, 'r') as file:
        linesnew = ['E' + line[1:] for line in file]
    with open(path, 'w') as file:
        for line in linesnew:
            file.write(line)


def collect_exes_only():
    path = 'C:\\Users\\Ben\\Desktop\\bigproject_repository\\onlyexelist.txt'
    path2 = 'C:\\Users\\Ben\\Desktop\\bigproject_repository\\exelist.txt'
    nums = []
    with open(path, 'r') as file:
        for cnt, line in enumerate(file):
            rawline = line.replace(" ", "")
            lines = rawline.partition(":")
            nums.append(int(lines[0][4:]) + 1)

    lines = []
    with open(path2, 'r') as file:
        for cnt, line in enumerate(file):
            a = cnt + 1
            if a in nums:
                lines.append(line[:-1])

    pathtowritelist = 'C:\\Users\\Ben\\Desktop\\bigproject_repository\\filteredonlyexelist.txt'
    with open(pathtowritelist, 'w') as f:
        for item in lines:
            f.write("%s\n" % item)


def collect_dlls_only():
    path = 'C:\\Users\\Ben\\Desktop\\bigproject_repository\\onlydlllist.txt'
    path2 = 'C:\\Users\\Ben\\Desktop\\bigproject_repository\\exelist.txt'
    nums = []
    with open(path, 'r') as file:
        for cnt, line in enumerate(file):
            rawline = line.replace(" ", "")
            lines = rawline.partition(":")
            nums.append(int(lines[0][4:]) + 1)

    lines = []
    with open(path2, 'r') as file:
        for cnt, line in enumerate(file):
            a = cnt + 1
            if a in nums:
                lines.append(line[:-1])

    pathtowritelist = 'C:\\Users\\Ben\\Desktop\\bigproject_repository\\filteredonlydlllist.txt'
    with open(pathtowritelist, 'w') as f:
        for item in lines:
            f.write("%s\n" % item)


def final_filtering_for_exe():
    pathtoreadlist = 'C:\\Users\\Ben\\Desktop\\bigproject_repository\\filteredonlyexelist.txt'
    pathtowritelist = 'C:\\Users\\Ben\\Desktop\\bigproject_repository\\filteredonlyexelist32.txt'
    exe_central_directory = "D:\\exesource32_bit"
    listpaths = [token.path for token in os.scandir(exe_central_directory)]
    listread = [exe_central_directory + '\\' + i[:-1] for i in open(pathtoreadlist, 'r')]
    finalset = set(listpaths) & set(listread)
    finallist = [i for i in finalset]

    with open(pathtowritelist, 'w') as file:
        for item in finallist:
            file.write("%s\n" % item)


def final_filtering_for_dll():
    pathtoreadlist = 'C:\\Users\\Ben\\Desktop\\bigproject_repository\\filteredonlydlllist.txt'
    pathtowritelist = 'C:\\Users\\Ben\\Desktop\\bigproject_repository\\filteredonlydlllist32.txt'
    exe_central_directory = "D:\\exesource32_bit"
    listsource = [token.path for token in os.scandir(exe_central_directory)]
    listread = [exe_central_directory + '\\' + i[:-1] for i in open(pathtoreadlist, 'r')]
    finalset = set(listsource) & set(listread)
    finallist = [i for i in finalset]

    with open(pathtowritelist, 'w') as file:
        for item in finallist:
            file.write("%s\n" % item)


def real_directory_conversion():
    path = 'C:\\Users\\Ben\\Desktop\\bigproject_repository\\onlyexelist.txt'
    cleanpath = 'C:\\Users\\Ben\\Desktop\\bigproject_repository\\onlyexelistclean.txt'
    write_data = []
    with open(path, 'r') as file:
        for cnt, line in enumerate(file):
            if 'C:' in line:
                index_cut_off = line.index('C:')
                write_data.append(line[index_cut_off:-1])
            else:
                index_cut_off = line.index('D:')
                write_data.append(line[index_cut_off:-1])

    with open(cleanpath, 'w') as file:
        for item in write_data:
            file.write("%s\n" % item)
